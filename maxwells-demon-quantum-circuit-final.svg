<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600">
  <!-- Background with extended width -->
  <rect width="1000" height="600" fill="#f0f8ff"/>
  
  <!-- Quantum Circuit Board -->
  <rect x="100" y="100" width="600" height="400" fill="#e6e6fa" stroke="#4b0082" stroke-width="3"/>
  
  <!-- Quantum Wires -->
  <line x1="150" y1="150" x2="650" y2="150" stroke="#4169e1" stroke-width="3"/>
  <line x1="150" y1="200" x2="650" y2="200" stroke="#4169e1" stroke-width="3"/>
  <line x1="150" y1="250" x2="650" y2="250" stroke="#4169e1" stroke-width="3"/>
  <line x1="150" y1="300" x2="650" y2="300" stroke="#4169e1" stroke-width="3"/>
  
  <!-- Dotted lines indicating many more wires -->
  <line x1="150" y1="330" x2="650" y2="330" stroke="#4169e1" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="150" y1="340" x2="650" y2="340" stroke="#4169e1" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="150" y1="350" x2="650" y2="350" stroke="#4169e1" stroke-width="2" stroke-dasharray="5,5"/>
  
  <!-- Last wire -->
  <line x1="150" y1="400" x2="650" y2="400" stroke="#4169e1" stroke-width="3"/>
  
  <!-- Qubit Markers -->
  <circle cx="150" cy="150" r="6" fill="#ff4500"/>
  <circle cx="150" cy="200" r="6" fill="#ff4500"/>
  <circle cx="150" cy="250" r="6" fill="#ff4500"/>
  <circle cx="150" cy="300" r="6" fill="#ff4500"/>
  <circle cx="150" cy="400" r="6" fill="#ff4500"/>
  
  <!-- Qubit Labels -->
  <text x="130" y="150" text-anchor="end" fill="#4b0082" font-family="Arial" font-size="12">ρ₁</text>
  <text x="130" y="200" text-anchor="end" fill="#4b0082" font-family="Arial" font-size="12">ρ₂</text>
  <text x="130" y="250" text-anchor="end" fill="#4b0082" font-family="Arial" font-size="12">ρ₃</text>
  <text x="130" y="300" text-anchor="end" fill="#4b0082" font-family="Arial" font-size="12">ρ₄</text>
  <text x="130" y="400" text-anchor="end" fill="#4b0082" font-family="Arial" font-size="12">ρₙ</text>
  
  <!-- Time Step Labels and Legend outside the figure -->
  <text x="300" y="520" text-anchor="middle" fill="#4b0082" font-family="Arial" font-weight="bold" font-size="16">Time Step 1</text>
  <text x="500" y="520" text-anchor="middle" fill="#4b0082" font-family="Arial" font-weight="bold" font-size="16">Time Step 2</text>
  
  <!-- PSWAP Legend outside and under the figure -->
  <rect x="350" y="550" width="30" height="40" fill="rgba(255,99,71,0.7)" stroke="#4b0082" stroke-width="2" rx="5" ry="5"/>
  <text x="390" y="575" fill="#4b0082" font-family="Arial" font-size="16" font-weight="bold">: PSWAP Gate</text>
  
  <!-- PSWAP Gates - Time Step 1 -->
  <!-- PSWAP between qubits 1 and 2 (no text) -->
  <rect x="280" y="140" width="40" height="70" fill="rgba(255,99,71,0.7)" stroke="#4b0082" stroke-width="2" rx="5" ry="5"/>
  
  <!-- PSWAP between qubits 3 and 4 (no text) -->
  <rect x="280" y="240" width="40" height="70" fill="rgba(255,99,71,0.7)" stroke="#4b0082" stroke-width="2" rx="5" ry="5"/>
  
  <!-- PSWAP between last qubit and dotted lines (no text) -->
  <rect x="280" y="340" width="40" height="70" fill="rgba(255,99,71,0.7)" stroke="#4b0082" stroke-width="2" rx="5" ry="5"/>
  
  <!-- PSWAP Gates - Time Step 2 -->
  <!-- PSWAP between qubit 1 and qubit n (looping) -->
  <!-- Small rectangle on q1 -->
  <rect x="480" y="140" width="40" height="20" fill="rgba(255,99,71,0.7)" stroke="#4b0082" stroke-width="2" rx="5" ry="5"/>
  <!-- Dotted line going vertically down -->
  <line x1="500" y1="160" x2="500" y2="380" stroke="#4b0082" stroke-width="2" stroke-dasharray="5,5"/>
  <!-- Small rectangle on qn -->
  <rect x="480" y="390" width="40" height="20" fill="rgba(255,99,71,0.7)" stroke="#4b0082" stroke-width="2" rx="5" ry="5"/>
  <!-- Text label in the middle (removed) -->
  
  <!-- PSWAP between qubit 2 and 3 (no text) -->
  <rect x="560" y="190" width="40" height="70" fill="rgba(255,99,71,0.7)" stroke="#4b0082" stroke-width="2" rx="5" ry="5"/>
  
  <!-- PSWAP between qubit 4 and dotted lines (no text) -->
  <rect x="560" y="290" width="40" height="70" fill="rgba(255,99,71,0.7)" stroke="#4b0082" stroke-width="2" rx="5" ry="5"/>
  
  <!-- Maxwell's Demon -->
  <!-- Head -->
  <circle cx="400" cy="75" r="30" fill="#ff6347"/>
  
  <!-- Horns -->
  <path d="M385 50 L375 20 L390 45" fill="#800000" stroke="#800000" stroke-width="2"/>
  <path d="M415 50 L425 20 L410 45" fill="#800000" stroke="#800000" stroke-width="2"/>
  
  <!-- Face -->
  <circle cx="390" cy="70" r="5" fill="white"/>
  <circle cx="390" cy="70" r="2" fill="black"/>
  <circle cx="410" cy="70" r="5" fill="white"/>
  <circle cx="410" cy="70" r="2" fill="black"/>
  <path d="M385 90 Q400 100 415 90" fill="none" stroke="black" stroke-width="2"/>
  
  <!-- Body (no legs) - 1.5x bigger -->
  <path d="M400 105 L375 145 L425 145 Z" fill="#ff6347"/>
  
  <!-- Arms -->
  <!-- Left arm to first time step - adjusted for bigger body -->
  <line x1="380" y1="130" x2="300" y2="200" stroke="#ff6347" stroke-width="8" stroke-linecap="round"/>
  <!-- Right arm to second time step - adjusted for bigger body -->
  <line x1="420" y1="130" x2="560" y2="230" stroke="#ff6347" stroke-width="8" stroke-linecap="round"/>
  
  <!-- Hands with tools -->
  <circle cx="300" cy="200" r="10" fill="#ff6347"/>
  <rect x="290" y="200" width="15" height="5" fill="#c0c0c0" transform="rotate(-30 300 200)"/>
  
  <circle cx="560" cy="230" r="10" fill="#ff6347"/>
  <path d="M555 225 L565 235 M565 225 L555 235" stroke="#c0c0c0" stroke-width="2"/>
  
  <!-- Tail with triangle pointing down - adjusted for bigger body -->
  <path d="M400 145 Q440 180 420 210" fill="none" stroke="#ff6347" stroke-width="8" stroke-linecap="round"/>
  <!-- Triangle with base connected to tail, pointing downward (half size, no outline) -->
  <polygon points="410,210 430,210 420,225" fill="#ff6347"/>
  
  <!-- Thought Cloud from Demon's Head - to the right and above -->
  <!-- Cloud outline -->
  <path d="M440 15 
           C455 5, 470 0, 485 5 
           C495 -5, 510 -5, 520 5
           C535 0, 545 10, 540 20
           C550 30, 545 40, 535 45
           C540 55, 530 65, 520 62
           C515 72, 500 75, 490 67
           C480 75, 465 72, 460 65
           C450 70, 440 65, 438 58
           C428 55, 425 45, 433 38
           C425 30, 430 20, 438 18
           C435 8, 445 3, 440 15" 
        fill="white" stroke="#4b0082" stroke-width="2"/>
  
  <!-- Mathematical expressions inside the cloud -->
  <text x="485" y="25" text-anchor="middle" font-family="serif" font-size="10" font-style="italic">I ⊗ I ⊗ ... ⊗ Z_i ⊗ I</text>
  <text x="485" y="40" text-anchor="middle" font-family="serif" font-size="10" font-style="italic">X ⊗ Y - Y ⊗ X</text>
  <text x="485" y="55" text-anchor="middle" font-family="serif" font-size="10" font-style="italic">D({ρ_q}(t)|| ρ̄)</text>
  
  <!-- Connection line from demon's head to thought cloud -->
  <path d="M425 50 Q435 45, 440 40" fill="none" stroke="#4b0082" stroke-width="2" stroke-dasharray="3,2"/>

  <!-- Heat Map Evolution of 12 Qubits with placeholder - clearly visible to the right -->
  <!-- Background box -->
  <rect x="750" y="120" width="200" height="360" fill="#ffffff" stroke="#000000" stroke-width="4" rx="10" ry="10"/>
  
  <!-- Title for heat map -->
  <text x="850" y="150" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Qubit Evolution</text>
  
  <!-- Time labels -->
  <text x="800" y="175" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">t₀</text>
  <text x="850" y="175" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">t₁</text>
  <text x="900" y="175" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">t₂</text>
  
  <!-- Placeholder grid for heat map cells -->
  <!-- Initial state column -->
  <rect x="790" y="190" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="790" y="210" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="790" y="230" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="790" y="250" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="790" y="270" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="790" y="290" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="790" y="310" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="790" y="330" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="790" y="350" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="790" y="370" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="790" y="390" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="790" y="410" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  
  <!-- Intermediate state column -->
  <rect x="840" y="190" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="840" y="210" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="840" y="230" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="840" y="250" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="840" y="270" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="840" y="290" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="840" y="310" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="840" y="330" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="840" y="350" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="840" y="370" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="840" y="390" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="840" y="410" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  
  <!-- Final state column -->
  <rect x="890" y="190" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="890" y="210" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="890" y="230" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="890" y="250" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="890" y="270" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="890" y="290" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="890" y="310" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="890" y="330" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="890" y="350" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="890" y="370" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="890" y="390" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  <rect x="890" y="410" width="20" height="20" fill="#ffffff" stroke="#000" stroke-width="1.5"/>
  
  <!-- Placeholder text removed -->
  
  <!-- Connection to circuit -->
  <path d="M650 250 L750 250" fill="none" stroke="#4b0082" stroke-width="2.5" stroke-dasharray="10,5"/>
  
  <!-- Non-equilibrium label -->
  <text x="850" y="455" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold" fill="#800000">Non-Equilibrium</text>
  <text x="850" y="475" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold" fill="#800000">Final State</text>
</svg>
